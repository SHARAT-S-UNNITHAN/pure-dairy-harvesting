{% extends "base.html" %}

{% block content %}
<div class="card">
    <h2>Farmer Dashboard</h2>
    <p>Welcome, {{ user.name }}! Manage your dairy products here.</p>
    
    <div class="dashboard-stats">
        <div class="stat-card">
            <h3>Total Products</h3>
            <p>{{ products|length }}</p>
        </div>
        <div class="stat-card">
            <h3>Approved Products</h3>
            <p>{{ products|selectattr('approved')|list|length }}</p>
        </div>
        <div class="stat-card">
            <h3>Pending Approval</h3>
            <p>{{ products|rejectattr('approved')|list|length }}</p>
        </div>
    </div>
    
    <div class="actions">
        <a href="{{ url_for('add_product') }}" class="button">Add New Product</a>
    </div>
</div>

<div class="card">
    <h3>Your Products</h3>
    {% if products %}
    <div class="product-list">
        {% for product in products %}
        <div class="product-item">
            <div class="product-info">
                <h4>{{ product.name }}</h4>
                <p>Price: â‚¹{{ product.price }} | Stock: {{ product.quantity }}</p>
                <p>Status: {% if product.approved %}Approved{% else %}Pending Approval{% endif %}</p>
                {% if product.category %}
                <p>Category: {{ product.category.name }}</p>
                {% endif %}
            </div>
            <div class="product-actions">
                <a href="{{ url_for('update_product', id=product.id) }}" class="button secondary">Edit</a>
                <a href="{{ url_for('delete_product', id=product.id) }}" class="button danger" onclick="return confirm('Are you sure you want to delete this product?')">Delete</a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p>You haven't added any products yet.</p>
    {% endif %}
</div>
{% endblock %}